# 📋 发布检查清单

## 🚀 发布前准备

### 1. 代码准备
- [ ] 所有功能开发完成并测试通过
- [ ] 代码已合并到 main 分支
- [ ] 没有未解决的严重 Bug
- [ ] 更新了 CHANGELOG.md（如果有）

### 2. 版本管理
- [ ] 确定版本号（遵循语义化版本规范）
  - 🐛 **补丁版本** (1.0.0 → 1.0.1) - Bug修复
  - ✨ **次版本** (1.0.0 → 1.1.0) - 新功能
  - 💥 **主版本** (1.0.0 → 2.0.0) - 破坏性变更
- [ ] 更新 `package.json` 中的版本号
- [ ] 更新应用内版本显示（如果有）

### 3. 构建配置检查
- [ ] 确认 `package.json` 中的仓库信息正确
  ```json
  {
    "build": {
      "publish": {
        "owner": "your-github-username",
        "repo": "my-browser"
      }
    }
  }
  ```
- [ ] 图标文件已准备就绪
  - [ ] `build/icon.ico` (Windows)
  - [ ] `build/icon.icns` (macOS)
  - [ ] `build/icon.png` (Linux)
- [ ] GitHub Actions 权限已正确设置

### 4. 本地测试
- [ ] 本地开发模式运行正常：`pnpm run dev`
- [ ] 本地构建成功：`pnpm run build`
- [ ] 构建产物可以正常安装和运行

## 🏗️ 发布流程

### 1. 更新版本号
```bash
# 选择合适的版本类型
npm version patch   # 1.0.0 → 1.0.1
npm version minor   # 1.0.0 → 1.1.0  
npm version major   # 1.0.0 → 2.0.0

# 或者手动设置版本
npm version 1.2.3
```

### 2. 推送代码和标签
```bash
# 推送代码到远程仓库
git push origin main

# 推送标签（这会触发自动构建和发布）
git push origin --tags
```

### 3. 监控构建过程
1. 进入 GitHub 仓库的 **Actions** 页面
2. 查看 "Build and Release" 工作流状态
3. 确认所有平台构建成功

### 4. 验证发布结果
- [ ] GitHub Release 页面显示新版本
- [ ] 各平台安装包已正确上传
- [ ] Release 说明自动生成
- [ ] 下载链接可以正常访问

## 🧪 发布后验证

### 1. 安装包测试
下载并测试各平台的安装包：
- [ ] **Windows** - 下载 `.exe` 文件，测试安装和运行
- [ ] **macOS** - 下载 `.dmg` 文件，测试安装和运行
- [ ] **Linux** - 下载 `.AppImage` 文件，测试运行

### 2. 功能验证
- [ ] 应用能够正常启动
- [ ] 核心功能工作正常
- [ ] 新功能运行正常
- [ ] 界面显示正确
- [ ] 没有明显的性能问题

### 3. 自动更新测试（如果配置了）
- [ ] 应用能检测到新版本
- [ ] 更新机制工作正常
- [ ] 更新后应用正常运行

## 🛠️ 故障排除

### 构建失败
如果 GitHub Actions 构建失败：

1. **查看错误日志**
   - 点击失败的工作流
   - 查看具体失败的步骤
   - 分析错误信息

2. **常见问题解决**
   ```bash
   # 权限问题
   # 检查仓库 Settings → Actions → General → Workflow permissions
   
   # 依赖问题
   # 检查 package.json 和 pnpm-lock.yaml
   
   # 图标问题
   # 确保 build/ 目录下有正确的图标文件
   
   # 配置问题
   # 检查 package.json 中的 build 配置
   ```

3. **重新触发构建**
   ```bash
   # 修复问题后，重新推送标签
   git tag -d v1.0.0              # 删除本地标签
   git push origin :refs/tags/v1.0.0  # 删除远程标签
   git tag v1.0.0                 # 重新创建标签
   git push origin v1.0.0         # 重新推送标签
   ```

### 发布问题
如果 Release 创建失败：

1. **手动创建 Release**
   - 进入 GitHub 仓库 Releases 页面
   - 点击 "Create a new release"
   - 选择对应的标签
   - 手动上传构建产物

2. **检查权限设置**
   - 确保 Actions 有写入 Releases 的权限
   - 检查 GitHub Token 权限

## 📊 发布指标监控

### 下载统计
在 GitHub Release 页面可以查看：
- 各平台安装包下载次数
- 总下载量
- 用户反馈

### 版本采用率
通过应用内统计（如果实现了）：
- 用户更新速度
- 版本分布情况
- 问题反馈

## 📝 发布后工作

### 1. 用户通知
- [ ] 更新项目 README.md
- [ ] 在相关社区/论坛发布更新通知
- [ ] 更新应用商店描述（如果有）

### 2. 文档更新
- [ ] 更新用户文档
- [ ] 更新 API 文档（如果有）
- [ ] 更新安装指南

### 3. 问题跟踪
- [ ] 监控用户反馈和问题报告
- [ ] 准备热修复版本（如果需要）
- [ ] 规划下一个版本的功能

## 🔄 回滚计划

如果发布的版本有严重问题：

### 1. 紧急回滚
```bash
# 创建回滚版本
npm version patch  # 例如 1.0.1 → 1.0.2
git tag v1.0.2
git push origin v1.0.2
```

### 2. 撤回发布
- 将有问题的 Release 标记为 "Pre-release"
- 在 Release 说明中添加问题警告
- 暂停推广和分发

### 3. 问题修复
- 快速修复关键问题
- 发布修复版本
- 通知用户更新

---

## ✅ 发布成功标准

一个成功的发布应该满足：
- 🟢 所有平台构建成功
- 🟢 安装包可以正常下载和安装
- 🟢 应用功能正常工作
- 🟢 没有严重的性能问题
- 🟢 用户反馈积极
- 🟢 没有紧急问题需要热修复

**🎉 恭喜！版本发布成功！**